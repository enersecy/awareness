
<!DOCTYPE html>
<html>
<head>
  <title></title>
  <meta charset="utf-8" />

  <!-- For the Office UI Fabric, go to http://aka.ms/office-ui-fabric to learn more. -->
  <link rel="stylesheet" href="https://appsforoffice.microsoft.com/fabric/2.1.0/fabric.min.css" />
  <link rel="stylesheet" href="https://appsforoffice.microsoft.com/fabric/2.1.0/fabric.components.min.css" />

  <script src="https://ipagave.azurewebsites.net/ReportMessage/jquery-1.9.1.min.js" type="text/javascript"></script>
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js" type="text/javascript"></script>
  <script src="https://ipagave.azurewebsites.net/ReportMessage/knockout-min.js"></script>

  <!--<script src="../Scripts/Microsoft.Exchange.Hygiene.WebExtension.Strings.ReportMessage.js"></script>-->
  <script>
    var ReportMessageStrings = {
      "de-de": { CancelButton: "Abbrechen", CannotShowHelpDialog: 'Sie können nicht über das Dialogfeld auf diesem Client auf die "Hilfe" zugreifen. Um Hilfe zu erhalten, wechseln Sie zu "https://aka.ms/ReportMesageHelp".', CannotShowOptionsDialog: 'Sie können Ihre Optionen nicht über das Dialogfeld auf diesem Client aktualisieren. Um sie zu aktualisieren, wechseln Sie zu "https://aka.ms/ReportMessageOptions".', Error12002: "URL kann nicht geladen werden.", Error12003: "Ungültige URL-Syntax.", Error12004: "Die Domäne befindet sich nicht in der Liste sicherer Domänen.", Error12005: "HTTPS ist erforderlich.", Error12006: "Das Dialogfeld ist geschlossen.", Error12007: "Das Dialogfeld ist bereits geöffnet.", FocusedFeedbackReportConfirmation: "Möchten Sie eine Kopie dieser Nachricht an Microsoft senden, um bei der Forschung und Verbesserung des Posteingangs mit Relevanz zu helfen?", FocusedFeedbackReportTitle: '"Relevant" oder "Sonstige"?', GeneralFailure: "Wir können Ihre Meldung im Moment nicht abschließen. Versuchen Sie es bitte später noch mal.", GetItemFailed: "Die Nachricht kann nicht vom Exchange-Server abgerufen werden, weil die Nachricht immer noch nicht zwischen Client und Server synchronisiert wurde. Versuchen Sie es bitte später noch mal.", JunkReportTitle: "Als Junk-E-Mail melden", MaintenanceMode: "Der Dienst ist nicht verfügbar, und wir reparieren ihn im Moment. Versuchen Sie es bitte später noch mal.", NotJunkReportTitle: "Als Nicht-Junk-E-Mail melden", NotReportButton: "Nicht melden", NotShowAgain: "Nicht mehr anzeigen.", OKButton: "OK", OptionsAsk: "Mich vor dem Senden eines Berichts fragen", OptionsAuto: "Berichte automatisch senden", OptionsDialogMessage1: "Das Melden von Junk- oder Phishing-E-Mail bei Microsoft hilft bei der Verringerung unerwünschter E-Mails.", OptionsDialogMessage2: "Wenn Nachrichten als Junk-E-Mail oder Phishing markiert werden:", OptionsDialogTitle: "Optionen für das Melden von Junk-E-Mails", OptionsNever: "Nie Berichte senden", OptionsSaveFailed: "Änderungen an Ihren Optionen konnten nicht gespeichert werden. Versuchen Sie es bitte später noch mal.", OptionsSaveSucceeded: "Ihre Optionsänderungen wurden erfolgreich gespeichert.", PhishingReportMessage: "Phishing-E-Mails sind darauf ausgelegt, an Ihre persönlichen Informationen zu gelangen, um Ihnen diese zu stehlen. Dies erfolgt durch das Fälschen beliebter Websites oder die Aufnahme bösartiger Links in den Nachrichtentext.", PhishingReportTitle: "Als Phishing melden", ReportButton: "Melden", ReportFocusedFeedbackNotInInbox: 'Nur Nachrichten im Ordner "Posteingang" können im Rahmen des Feedbacks zu "Relevant" gemeldet werden.', ReportJunkInJunk: 'Diese Nachricht befindet sich bereits im Ordner "Junk-E-Mail".', ReportJunkSucceeded: 'Diese Nachricht wird in den Ordner "Junk-E-Mail" verschoben.', ReportNotJunkInNotJunk: 'Nur Nachrichten, die sich im Ordner "Junk-E-Mail" befinden, können als "Nicht-Junk-E-Mail" gemeldet werden.', ReportNotJunkSucceeded: "Diese Nachricht wird in den Posteingang verschoben.", ReportPhishSucceeded: 'Diese Nachricht wurde als Phishing markiert und wird in den Ordner "Junk-E-Mail" verschoben.', ReportingConfirmation: "Möchten Sie eine Kopie dieser Nachricht an Microsoft senden, um bei der Forschung und Verbesserung von E-Mail-Schutztechnologien zu helfen?", SaveButton: "Speichern", ZZ: "ZZ" },
      "en-gb": { CancelButton: "Cancel", CannotShowHelpDialog: "You can't access Help using the dialogue box in this client. To get help, go to https://aka.ms/ReportMesageHelp.", CannotShowOptionsDialog: "You can't update your options using the dialogue box in this client. To update them, go to https://aka.ms/ReportMessageOptions.", Error12002: "Cannot load URL.", Error12003: "Invalid URL syntax.", Error12004: "Domain is not in safe domain list.", Error12005: "HTTPS is required.", Error12006: "Dialogue is closed.", Error12007: "Dialogue has already been opened.", FocusedFeedbackReportConfirmation: "Do you want to send a copy of this message to Microsoft to help the research and improvement of Focused Inbox?", FocusedFeedbackReportTitle: "Focused or Other?", GeneralFailure: "We can't complete your report at the moment. Please try again later.", GetItemFailed: "We cannot get the message from the Exchange server as the message has still not been synchronised between the client and the server. Please try again later.", JunkReportTitle: "Report as spam", MaintenanceMode: "The service is not available and we are currently fixing it. Please try again later.", NotJunkReportTitle: "Report as not spam", NotReportButton: "Don't Report", NotShowAgain: "Don't show me this message again.", OKButton: "OK", OptionsAsk: "Ask me before sending a report", OptionsAuto: "Automatically send reports", OptionsDialogMessage1: "Reporting spam or phishing emails to Microsoft helps reduce unwanted emails.", OptionsDialogMessage2: "When messages are reported as spam or phishing:", OptionsDialogTitle: "Spam email reporting options", OptionsNever: "Never send reports", OptionsSaveFailed: "Changes to your options couldn't be saved. Please try again later.", OptionsSaveSucceeded: "Your options changes were saved successfully.", PhishingReportMessage: "Phishing emails are designed to obtain your personal information to steal from you. This is done by impersonating popular websites or including malicious links in the body of a message.", PhishingReportTitle: "Report as phishing", ReportButton: "Report", ReportFocusedFeedbackNotInInbox: "Only messages which are in the Inbox folder can be reported to Focused Feedback.", ReportJunkInJunk: "This message is already in the Spam Email folder.", ReportJunkSucceeded: "This message will be moved to the Spam Email folder.", ReportNotJunkInNotJunk: "Only messages which are in the Spam Email folder can be reported as Not Spam.", ReportNotJunkSucceeded: "This message will be moved to the Inbox.", ReportPhishSucceeded: "This message has been marked as Phishing and will be moved to the Spam Email folder.", ReportingConfirmation: "Do you want to send a copy of this message to Microsoft to aid the research and improvement of email protection technologies?", SaveButton: "Save", ZZ: "ZZ" },
      "en-us": { CancelButton: "Cancel", CannotShowHelpDialog: "You can't access Help using the dialog box on this client. To get help, go to https://aka.ms/ReportMesageHelp.", CannotShowOptionsDialog: "You can't update your options using the dialog box on this client. To update them, go to https://aka.ms/ReportMessageOptions.", Error12002: "Cannot load URL.", Error12003: "Invalid URL syntax.", Error12004: "Domain is not in safe domain list.", Error12005: "HTTPS is required.", Error12006: "Dialog is closed.", Error12007: "Dialog is already opened.", FocusedFeedbackReportConfirmation: "Do you want to send a copy of this message to Microsoft to help the research and improvement of Focused Inbox?", FocusedFeedbackReportTitle: "Focused or Other?", GeneralFailure: "We can't complete your report right now. Please try again later.", GetItemFailed: "Cannot get the message from Exchange server as the message is still not synced between client and server, please try again later.", JunkReportTitle: "Report as junk", MaintenanceMode: "The service is not available and we are fixing it right now. Please try later.", NotJunkReportTitle: "Report as not junk", NotReportButton: "Don't Report", NotShowAgain: "Don't show me this message again.", OKButton: "OK", OptionsAsk: "Ask me before sending a report", OptionsAuto: "Automatically send reports", OptionsDialogMessage1: "Reporting junk or phishing email to Microsoft helps reduce unwanted email.", OptionsDialogMessage2: "When messages are reported as junk or phishing:", OptionsDialogTitle: "Junk email reporting options", OptionsNever: "Never send reports", OptionsSaveFailed: "Changes to your options couldn't be saved. Please try again later.", OptionsSaveSucceeded: "Your options changes were saved successfully.", PhishingReportMessage: "Phishing email is designed to obtain your personal information to steal from you. This is done by impersonating popular websites or including malicious links in the body of a message.", PhishingReportTitle: "Report as phishing", ReportButton: "Report", ReportFocusedFeedbackNotInInbox: "Only messages which are in the Inbox folder can be reported to Focused Feedback.", ReportJunkInJunk: "This message is already in the Junk Email folder.", ReportJunkSucceeded: "This message will be moved to the Junk Email folder.", ReportNotJunkInNotJunk: "Only messages which are in the Junk Email folder can be reported as Not Junk.", ReportNotJunkSucceeded: "This message will be moved to the Inbox.", ReportPhishSucceeded: "This message has been marked as Phishing and will be moved to the Junk Email folder.", ReportingConfirmation: "Do you want to send a copy of this message to Microsoft to help the research and improvement of email protection technologies?", SaveButton: "Save", ZZ: "ZZ" }
       };
  </script>

  <!--<script src="../Scripts/Common.js" type="text/javascript"></script>-->
  <script>
    "use strict";

    Office.initialize = function () {
    };

    (function ($) {
      $.QueryString = (function (a) {
        if (a === "") return {};
        var b = {};
        for (var i = 0; i < a.length; ++i) {
          var p = a[i].split('=');
          if (p.length !== 2) continue;
          b[p[0]] = decodeURIComponent(p[1].replace(/\+/g, " "));
        }
        return b;
      })(window.location.search.substr(1).split('&'));
    })(jQuery);

    function getLocaleStrings(strings, locale) {
      var locStrings = strings["en-us"];
      if (locale === undefined) {
        locale = $.QueryString.locale;
      }
      if (locale === undefined && Office.context !== undefined) {
        locale = Office.context.displayLanguage;
      }
      if (locale !== undefined && locale !== null) {
        locStrings = strings[locale.toLowerCase()];
      }
      if (locStrings === undefined) {
        locStrings = strings["en-us"];
      }
      return locStrings;
    }
  </script>

  <script>
    function messageParent(action) {
      var text = '{ "source":"Dialog", "action":"' + action + '" }';
      Office.context.ui.messageParent(text);
    }

    function onLoad() {
      var title = $.QueryString.title;
      var msg = $.QueryString.msg;
      var redir = $.QueryString.redir;

      if (redir !== undefined) {
        // Redirect
        window.location.href = redir;
      } else {
        $('#content').show();
        ////$("#title").text(title);
        $("#msg").html(msg);
      }
    }
  </script>
</head>
<body onload="onLoad()">
  <div id="content" style="display: none">
    <div id="content-header">
      <div class="padding">
        <p id="title" class="ms-font-xl ms-fontColor-themeDarkAlt ms-fontWeight-semilight"></p>
      </div>
    </div>
    <div id="content-main" class="ms-Grid">
      <div class="ms-font-l">
        <p id="msg"></p>
        <button onclick="messageParent('OK')" data-bind="text: Strings.OKButton"></button>
      </div>
    </div>
  </div>

  <script>
    function ViewModel() {
      this.Strings = getLocaleStrings(ReportMessageStrings);
    };

    ko.applyBindings(new ViewModel());
  </script>
</body>
</html>
